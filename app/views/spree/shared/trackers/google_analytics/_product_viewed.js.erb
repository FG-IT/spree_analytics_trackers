<% if defined?(segment_tracker) && ga_enabled? && @product.present? %>
<% variant = begin default_variant(@variants, @product) rescue @product end %>
<script >
window.addEventListener('turbolinks:load', function () {
    <% fa_product_price = @product.price %>
    <% fa_event = 'view_item' %>
    gtag('event', '<%= fa_event %>', {
        'send_to': '<%= ga_tracker.analytics_id %>',
        'value': <%= fa_product_price %>,
        'currency': '<%=current_currency %>',
        'items': [<%=product_for_ga(@product,variant) %>]
    });
});
</script>
<% end %>
